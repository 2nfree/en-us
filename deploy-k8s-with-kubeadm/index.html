<!DOCTYPE html><html lang="en_US" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Deploy Kubernetes With Kubeadm | Gengar's Pokeball</title><meta name="author" content="komorebi"><meta name="copyright" content="komorebi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="This document provides a step-by-step guide to deploying a Kubernetes cluster using Kubeadm. The deployment process includes setting up the control plane node and worker nodes, and verifying the clust"><meta property="og:type" content="article"><meta property="og:title" content="Deploy Kubernetes With Kubeadm"><meta property="og:url" content="https://blog.2nfree.com/en-us/deploy-k8s-with-kubeadm/"><meta property="og:site_name" content="Gengar&#39;s Pokeball"><meta property="og:description" content="This document provides a step-by-step guide to deploying a Kubernetes cluster using Kubeadm. The deployment process includes setting up the control plane node and worker nodes, and verifying the clust"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.2nfree.com/en-us/images/avatar.png"><meta property="article:published_time" content="2023-02-17T08:10:04.000Z"><meta property="article:modified_time" content="2023-03-11T01:24:38.000Z"><meta property="article:author" content="komorebi"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="DevOps"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.2nfree.com/en-us/images/avatar.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Deploy Kubernetes With Kubeadm",
  "url": "https://blog.2nfree.com/en-us/deploy-k8s-with-kubeadm/",
  "image": "https://blog.2nfree.com/en-us/images/avatar.png",
  "datePublished": "2023-02-17T08:10:04.000Z",
  "dateModified": "2023-03-11T01:24:38.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "komorebi",
      "url": "https://blog.2nfree.com/en-us/"
    }
  ]
}</script><link rel="shortcut icon" href="/en-us/images/logo.svg"><link rel="canonical" href="https://blog.2nfree.com/en-us/deploy-k8s-with-kubeadm/"><link rel="preconnect"><link rel="stylesheet" href="/en-us/css/index.css?v=5.3.2"><link rel="stylesheet" href="/en-us/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.7.2"><script>(()=>{const e={set:(e,t,o)=>{if(!o)return;const a=Date.now()+864e5*o;localStorage.setItem(e,JSON.stringify({value:t,expiry:a}))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const{value:o,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return o;localStorage.removeItem(e)}};window.btf={saveToLocal:e,getScript:(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,Object.entries(t).forEach(([e,t])=>n.setAttribute(e,t)),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)}),getCSS:(e,t)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)}),addGlobalFn:(e,t,o=!1,a=window)=>{if(e.startsWith("pjax"))return;const n=a.globalFn||{};n[e]=n[e]||{},n[e][o||Object.keys(n[e]).length]=t,a.globalFn=n}};const t=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},o=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};btf.activateDarkMode=t,btf.activateLightMode=o;const a=e.get("theme");"dark"===a?t():"light"===a&&o();const n=e.get("aside-status");void 0!==n&&document.documentElement.classList.toggle("hide-aside","hide"===n);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>const GLOBAL_CONFIG={root:"/en-us/",algolia:void 0,localSearch:{path:"/en-us/search.xml",preload:!0,top_n_per_article:1,unescape:!1,languages:{hits_empty:"No results found for: ${query}",hits_stats:"${hits} articles found"}},translate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200,highlightFullpage:!1,highlightMacStyle:!0},copy:{success:"Copy Successful",error:"Copy Failed",noSupport:"Browser Not Supported"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"Just now",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:void 0,lightbox:"null",Snackbar:void 0,infinitegrid:{js:"/en-us/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.12.0",buttonText:"Load More"},isPhotoFigcaption:!1,islazyloadPlugin:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Deploy Kubernetes With Kubeadm",isHighlightShrink:!1,isToc:!0,pageType:"post"}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/en-us/atom.xml" title="Gengar's Pokeball" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/en-us/images/avatar.png" onerror='this.onerror=null,this.src="/en-us/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/en-us/archives/"><div class="headline">Articles</div><div class="length-num">30</div></a><a href="/en-us/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/en-us/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en-us/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.2nfree.com"><i class="fa-fw fa-solid fa-language"></i><span> 简体中文</span></a></li><li><a class="site-page child" href="https://blog.2nfree.com/en-us"><i class="fa-fw fa-solid fa-language"></i><span> English</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/images/background-light.webp)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/en-us/"><img class="site-icon" src="/en-us/images/logo.svg" alt="Logo"><span class="site-name">Gengar's Pokeball</span></a><a class="nav-page-title" href="/en-us/"><span class="site-name">Deploy Kubernetes With Kubeadm</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en-us/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/en-us/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.2nfree.com"><i class="fa-fw fa-solid fa-language"></i><span> 简体中文</span></a></li><li><a class="site-page child" href="https://blog.2nfree.com/en-us"><i class="fa-fw fa-solid fa-language"></i><span> English</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Deploy Kubernetes With Kubeadm</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-02-17T08:10:04.000Z" title="Created 2023-02-17 16:10:04">2023-02-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-03-11T01:24:38.000Z" title="Updated 2023-03-11 09:24:38">2023-03-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en-us/categories/CloudNative/">CloudNative</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">1.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>8mins</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:100,&quot;messagePrev&quot;:&quot;This article was updated&quot;,&quot;messageNext&quot;:&quot;days ago, Please verify that the information is still up-to-date.&quot;,&quot;postUpdate&quot;:&quot;2023-03-11 09:24:38&quot;}" hidden></div><div class="note blue flat"><p>当前文档有中文版本：<a href="/deploy-k8s-with-kubeadm/">点击这里切换到中文</a>.</p></div><h1 id="Foreword"><a href="#Foreword" class="headerlink" title="Foreword"></a>Foreword</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This document provides a step-by-step guide to deploying a Kubernetes cluster using Kubeadm (version 1.21.11). The deployment process includes setting up the control plane node and worker nodes, and verifying the cluster’s functionality.</p><h1 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h1><h2 id="Servers"><a href="#Servers" class="headerlink" title="Servers"></a>Servers</h2><table><thead><tr><th><strong>HOST</strong></th><th><strong>IP</strong></th><th><strong>SYSTEM</strong></th></tr></thead><tbody><tr><td>master1</td><td>192.168.1.10</td><td>centos7</td></tr><tr><td>master2</td><td>192.168.1.11</td><td>centos7</td></tr><tr><td>node1</td><td>192.168.1.20</td><td>centos7</td></tr><tr><td>node2</td><td>192.168.1.21</td><td>centos7</td></tr></tbody></table><h2 id="Server-Port"><a href="#Server-Port" class="headerlink" title="Server Port"></a>Server Port</h2><p>Open the relevant firewall ports, modify the security group settings for the cloud server, and update the firewall rules on the local server.<br>For test you can set all trust or disable the firewall.</p><table><thead><tr><th><strong>UNIT</strong></th><th><strong>PORT</strong></th></tr></thead><tbody><tr><td>API Server</td><td>8080（http）<br>6443（https）</td></tr><tr><td>Controller Manager</td><td>10252</td></tr><tr><td>Scheduler</td><td>10251</td></tr><tr><td>kubelet</td><td>10250<br>10255（read only）</td></tr><tr><td>etcd</td><td>2379（client）<br>2380（etcd cluster）</td></tr><tr><td>DNS</td><td>53（UDP TCP）</td></tr><tr><td>CNI Calico</td><td>179</td></tr></tbody></table><h2 id="Basic-Tools"><a href="#Basic-Tools" class="headerlink" title="Basic Tools"></a>Basic Tools</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum update -y</span><br><span class="line">yum install net-tools curl wget epel-release vim gcc wget make libtool expat-devel pcre-devel openssl-devel libxml2-devel -y</span><br><span class="line">yum install git lsof ncdu psmisc htop openssl lrzsz -y</span><br><span class="line">yum install conntrack ipvsadm ipset jq sysstat iptables libseccomp -y</span><br></pre></td></tr></table></figure><h1 id="Install-Container-Runtime"><a href="#Install-Container-Runtime" class="headerlink" title="Install Container Runtime"></a>Install Container Runtime</h1><div class="note blue Container Runtime flat"><p>To run Kubernetes, container runtime support is required, so we need to install a container runtime on the server.<br>The most commonly used container runtime is Docker, but the officially recommended container runtime is Containerd.</p></div><div class="note tip flat"><p>Note: In Kubernetes version 1.24, support for docker-shim was removed. If you are installing a Kubernetes version higher than 1.24, it is recommended to install Containerd.</p></div><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">Docker</button><button type="button" class="tab">Containerd</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils \</span><br><span class="line">  device-mapper-persistent-data \</span><br><span class="line">  lvm2</span><br><span class="line"></span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># install</span></span><br><span class="line">yum install -y docker-ce docker-ce-cli containerd.io</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -pv /etc/docker</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/docker/daemon.json &lt;&lt;<span class="string">&quot;EOF&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;log-driver&quot;</span>:<span class="string">&quot;json-file&quot;</span>,</span><br><span class="line">  <span class="string">&quot;log-opts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;max-size&quot;</span>: <span class="string">&quot;5m&quot;</span>,</span><br><span class="line">    <span class="string">&quot;max-file&quot;</span>:<span class="string">&quot;3&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># start</span></span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">systemctl status docker</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># load mod</span></span><br><span class="line">modprobe overlay</span><br><span class="line">modprobe br_netfilter</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF | sudo tee /etc/modules-load.d/containerd.conf</span></span><br><span class="line"><span class="string">overlay</span></span><br><span class="line"><span class="string">br_netfilter</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># install the nerdctl toolkit</span></span><br><span class="line">wget https://github.com/containerd/nerdctl/releases/download/v1.0.0/nerdctl-full-1.0.0-linux-amd64.tar.gz</span><br><span class="line">tar Cxzvvf /usr/local nerdctl-full-1.0.0-linux-amd64.tar.gz</span><br><span class="line">systemctl <span class="built_in">enable</span> --now containerd</span><br><span class="line">systemctl <span class="built_in">enable</span> --now buildkit</span><br><span class="line"></span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /etc/containerd</span><br><span class="line">sudo containerd config default | sudo <span class="built_in">tee</span> /etc/containerd/config.toml</span><br><span class="line"></span><br><span class="line"><span class="comment"># edit config</span></span><br><span class="line">SystemdCgroup = <span class="literal">true</span></span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">[plugins.<span class="string">&quot;io.containerd.grpc.v1.cri&quot;</span>.registry]</span><br><span class="line">      config_path = <span class="string">&quot;/etc/containerd/certs.d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create dir</span></span><br><span class="line"><span class="built_in">mkdir</span> /etc/containerd/certs.d/docker.io -pv</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/containerd/certs.d/docker.io/hosts.toml &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">server = &quot;https://docker.io&quot;</span></span><br><span class="line"><span class="string">[host.&quot;https://docker.mirrors.ustc.edu.cn&quot;]</span></span><br><span class="line"><span class="string">  capabilities = [&quot;pull&quot;, &quot;resolve&quot;]</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">systemctl restart containerd</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h1 id="Server-System-Config"><a href="#Server-System-Config" class="headerlink" title="Server System Config"></a>Server System Config</h1><h2 id="Disable-Selinux"><a href="#Disable-Selinux" class="headerlink" title="Disable Selinux"></a>Disable Selinux</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># permanent</span></span><br><span class="line">sed -i <span class="string">&#x27;s/enforcing/disable/&#x27;</span> /etc/selinux/config</span><br><span class="line"><span class="comment"># temporary</span></span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure><h2 id="Disable-SWAP"><a href="#Disable-SWAP" class="headerlink" title="Disable SWAP"></a>Disable SWAP</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#（Some cloud services are turned off by default, which can be viewed with the free command or by looking at /etc/fstab）</span></span><br><span class="line"><span class="comment"># permanent</span></span><br><span class="line">swapoff -a</span><br><span class="line"><span class="comment"># temporary</span></span><br><span class="line">sed -ri <span class="string">&#x27;s/.*swap.*/#&amp;/&#x27;</span> /etc/fstab</span><br></pre></td></tr></table></figure><h2 id="Pass-bridged-IPV4-traffic-to-iptables"><a href="#Pass-bridged-IPV4-traffic-to-iptables" class="headerlink" title="Pass bridged IPV4 traffic to iptables"></a>Pass bridged IPV4 traffic to iptables</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># load mod</span></span><br><span class="line">modprobe br_netfilter</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/sysctl.d/kubernetes.conf &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-ip6tables = 1</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-iptables = 1</span></span><br><span class="line"><span class="string">net.ipv4.ip_forward = 1</span></span><br><span class="line"><span class="string">vm.swappiness=0</span></span><br><span class="line"><span class="string">vm.overcommit_memory = 1</span></span><br><span class="line"><span class="string">vm.panic_on_oom = 0</span></span><br><span class="line"><span class="string">fs.inotify.max_user_watches = 89100</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">sysctl -p /etc/sysctl.d/kubernetes.conf</span><br></pre></td></tr></table></figure><h2 id="IPVS-Config"><a href="#IPVS-Config" class="headerlink" title="IPVS Config"></a>IPVS Config</h2><p>In Kubernetes, there are two service proxy models: one based on iptables and another based on IPVS.<br>When comparing the two, the performance of IPVS is significantly higher. However, to use IPVS, you need to manually load the IPVS modules.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install ipset ipvsadmin -y</span><br></pre></td></tr></table></figure><p>load mod</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">low kernel version</button><button type="button" class="tab">high kernel version</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">modprobe -- ip_vs</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_rr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_wrr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_sh</span></span><br><span class="line"><span class="string">modprobe -- nf_conntrack_ipv4</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add executable permissions and execute</span></span><br><span class="line"><span class="built_in">chmod</span> +x /etc/sysconfig/modules/ipvs.modules</span><br><span class="line">sh /etc/sysconfig/modules/ipvs.modules</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">modprobe -- ip_vs</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_rr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_wrr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_sh</span></span><br><span class="line"><span class="string">modprobe -- nf_conntrack</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add executable permissions and execute</span></span><br><span class="line"><span class="built_in">chmod</span> +x /etc/sysconfig/modules/ipvs.modules</span><br><span class="line">sh /etc/sysconfig/modules/ipvs.modules</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="Set-up-time-synchronization-generally-cloud-service-vendors-have-already-set-it-up-local-servers-need-to-be-configured"><a href="#Set-up-time-synchronization-generally-cloud-service-vendors-have-already-set-it-up-local-servers-need-to-be-configured" class="headerlink" title="Set up time synchronization (generally cloud service vendors have already set it up, local servers need to be configured)"></a>Set up time synchronization (generally cloud service vendors have already set it up, local servers need to be configured)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install chrony</span><br><span class="line"></span><br><span class="line"><span class="comment"># start</span></span><br><span class="line">systemctl start chronyd</span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd</span><br></pre></td></tr></table></figure><h1 id="Install-Kubernetes"><a href="#Install-Kubernetes" class="headerlink" title="Install Kubernetes"></a>Install Kubernetes</h1><h2 id="Yum-Repo"><a href="#Yum-Repo" class="headerlink" title="Yum Repo"></a>Yum Repo</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[kubernetes]</span></span><br><span class="line"><span class="string">name=Kubernetes</span></span><br><span class="line"><span class="string">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">repo_gpgcheck=1</span></span><br><span class="line"><span class="string">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg</span></span><br><span class="line"><span class="string">exclude=kube*</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">yum install -y kubectl kubeadm kubelet --disableexcludes=kubernetes</span><br><span class="line"></span><br><span class="line">yum search kubeadm --showduplicates</span><br><span class="line"></span><br><span class="line">yum install -y kubectl-1.21.11-0.x86_64 kubeadm-1.21.11-0.x86_64 kubelet-1.21.11-0.x86_64 --disableexcludes=kubernetes</span><br></pre></td></tr></table></figure><h2 id="Start-Kubelet"><a href="#Start-Kubelet" class="headerlink" title="Start Kubelet"></a>Start Kubelet</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl start kubelet</span><br><span class="line">systemctl <span class="built_in">enable</span> kubelet</span><br><span class="line"><span class="comment"># It is normal for kubelet to report errors because the current cluster node is not up.</span></span><br><span class="line">systemctl status kubelet</span><br></pre></td></tr></table></figure><h1 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h1><h2 id="Get-Image-List"><a href="#Get-Image-List" class="headerlink" title="Get Image List"></a>Get Image List</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm config images list</span><br><span class="line">kubeadm config images list --kubernetes-version=v1.21.11</span><br><span class="line">kubeadm config images list --kubernetes-version=v1.21.11 --v=5</span><br></pre></td></tr></table></figure><h2 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm config images pull --kubernetes-version=v1.21.11</span><br><span class="line"></span><br><span class="line"><span class="comment"># check</span></span><br><span class="line">docker images &amp;&amp; nerdctl --namespace k8s.io images</span><br></pre></td></tr></table></figure><h1 id="Control-Plane"><a href="#Control-Plane" class="headerlink" title="Control Plane"></a>Control Plane</h1><h2 id="Init"><a href="#Init" class="headerlink" title="Init"></a>Init</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># docker (docker-shim is deprecated in higher versions, containerd is recommended)</span></span><br><span class="line">kubeadm init \</span><br><span class="line">  --control-plane-endpoint 192.168.1.10:6443 \</span><br><span class="line">  --kubernetes-version=v1.21.11  \</span><br><span class="line">  --pod-network-cidr=10.244.0.0/16 \</span><br><span class="line">  --service-cidr=10.96.0.0/12 --upload-certs</span><br><span class="line"></span><br><span class="line"><span class="comment"># containerd</span></span><br><span class="line">kubeadm init \</span><br><span class="line">  --kubernetes-version v1.21.11  \</span><br><span class="line">  --control-plane-endpoint 192.168.1.10:6443 \</span><br><span class="line">  --image-repository registry.aliyuncs.com/google_containers \</span><br><span class="line">  --pod-network-cidr 10.244.0.0/16 \</span><br><span class="line">  --cri-socket /run/containerd/containerd.sock \</span><br><span class="line">  --service-cidr=10.96.0.0/12 --upload-certs</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># retain following data, it will be used later</span></span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br><span class="line"></span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">  sudo <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">  sudo <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line">Alternatively, <span class="keyword">if</span> you are the root user, you can run:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br><span class="line"></span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run <span class="string">&quot;kubectl apply -f [podnetwork].yaml&quot;</span> with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line"></span><br><span class="line">You can now <span class="built_in">join</span> any number of the control-plane node running the following <span class="built_in">command</span> on each as root:</span><br><span class="line"></span><br><span class="line"> kubeadm <span class="built_in">join</span> 192.168.1.10:6443 --token grjzmr.ttkq7t4l3w9r2fb7\        --discovery-token-ca-cert-hash sha256:d9f4a8c6d14584b998a3ca86fd7e727f7d9d779f80e834dcf19e9116f22f3fad \</span><br><span class="line">        --control-plane --certificate-key 2346e1d55aa63ab30c3d7dca7529e9f91097383322e36336483a42ffa76e4c27</span><br><span class="line"></span><br><span class="line">Please note that the certificate-key gives access to cluster sensitive data, keep it secret!</span><br><span class="line">As a safeguard, uploaded-certs will be deleted <span class="keyword">in</span> two hours; If necessary, you can use</span><br><span class="line"><span class="string">&quot;kubeadm init phase upload-certs --upload-certs&quot;</span> to reload certs afterward.</span><br><span class="line"></span><br><span class="line">Then you can <span class="built_in">join</span> any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.1.10:6443 --token grjzmr.ttkq7t4l3w9r2fb7 \</span><br><span class="line">        --discovery-token-ca-cert-hash sha256:d9f4a8c6d14584b998a3ca86fd7e727f7d9d779f80e834dcf19e9116f22f3fad</span><br></pre></td></tr></table></figure><h2 id="Execute-Join-Control-Plane-in-master2"><a href="#Execute-Join-Control-Plane-in-master2" class="headerlink" title="Execute Join Control Plane in master2"></a>Execute Join Control Plane in master2</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm <span class="built_in">join</span> 192.168.1.10:6443 --token grjzmr.ttkq7t4l3w9r2fb7 \</span><br><span class="line">        --discovery-token-ca-cert-hash sha256:d9f4a8c6d14584b998a3ca86fd7e727f7d9d779f80e834dcf19e9116f22f3fad \</span><br><span class="line">        --control-plane --certificate-key 2346e1d55aa63ab30c3d7dca7529e9f91097383322e36336483a42ffa76e4c27</span><br></pre></td></tr></table></figure><h2 id="Perform-configuration-on-all-masters"><a href="#Perform-configuration-on-all-masters" class="headerlink" title="Perform configuration on all masters"></a>Perform configuration on all masters</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line"><span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"><span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br></pre></td></tr></table></figure><h1 id="Add-the-node-to-the-cluster"><a href="#Add-the-node-to-the-cluster" class="headerlink" title="Add the node to the cluster"></a>Add the node to the cluster</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubeadm <span class="built_in">join</span> 192.168.1.10:6443 --token grjzmr.ttkq7t4l3w9r2fb7 \</span><br><span class="line">        --discovery-token-ca-cert-hash sha256:d9f4a8c6d14584b998a3ca86fd7e727f7d9d779f80e834dcf19e9116f22f3fad</span><br></pre></td></tr></table></figure><h1 id="Install-the-CNI-network-plugin-do-it-on-master"><a href="#Install-the-CNI-network-plugin-do-it-on-master" class="headerlink" title="Install the CNI network plugin (do it on master)"></a>Install the CNI network plugin (do it on master)</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Check the node information, found that the current node is not ready, you need to install CNI, here choose Calico, you can also use others</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># download manifests</span></span><br><span class="line">wget https://docs.projectcalico.org/manifests/calico.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># apply</span></span><br><span class="line">kubectl apply -f calico.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># check</span></span><br><span class="line">kubectl get nodes</span><br></pre></td></tr></table></figure><h1 id="Use-IPVS"><a href="#Use-IPVS" class="headerlink" title="Use IPVS"></a>Use IPVS</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># view current IPVS rules</span></span><br><span class="line">ipvsadm -L -n</span><br><span class="line"></span><br><span class="line"><span class="comment"># edit kube-proxy config</span></span><br><span class="line">kubectl edit configmap -n kube-system kube-proxy</span><br><span class="line"><span class="comment"># Edit: `mode: &quot;ipvs&quot;`</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># restart kube-proxy，get pod and delete pod</span></span><br><span class="line">kubectl get pod -n kube-system -o wide | grep kube-proxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># check</span></span><br><span class="line">ipvsadm -L -n</span><br></pre></td></tr></table></figure><p>At this point the K8S cluster has been built, the cloud host can be configured through the NLB to achieve external access to the ApiService, the local server can be configured with Keepalived + HAProxy on the ApiService proxy!</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://blog.2nfree.com/en-us">komorebi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://blog.2nfree.com/en-us/deploy-k8s-with-kubeadm/">https://blog.2nfree.com/en-us/deploy-k8s-with-kubeadm/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en-us/tags/Kubernetes/">Kubernetes</a><a class="post-meta__tags" href="/en-us/tags/DevOps/">DevOps</a></div><div class="post-share"><div class="social-share" data-image="/en-us/images/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/en-us/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css?v=1.1.4" media="print" onload='this.media="all"'><script src="/en-us/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js?v=1.1.4" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/en-us/redis-config/" title="Redis Transactions And Configuration"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Redis Transactions And Configuration</div></div><div class="info-2"><div class="info-item-1">Redis Transactions and Some Advanced Configuration Explained</div></div></div></a><a class="pagination-related" href="/en-us/deploy-rook-ceph-on-k8s/" title="Deploy Rook Ceph On Kubernetes"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Deploy Rook Ceph On Kubernetes</div></div><div class="info-2"><div class="info-item-1">This document provides a method for installing a Ceph cluster in a Kubernetes cluster using Rook.</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/en-us/kind/" title="kind"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-25</div><div class="info-item-2">kind</div></div><div class="info-2"><div class="info-item-1">使用 Kind 启动测试用的多节点 K8S 集群</div></div></div></a><a class="pagination-related" href="/en-us/common-ops-for-kubernetes/" title="常见 Kubernetes 维护场景"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-22</div><div class="info-item-2">常见 Kubernetes 维护场景</div></div><div class="info-2"><div class="info-item-1">一些常见的 Kubernetes 维护场景</div></div></div></a><a class="pagination-related" href="/en-us/useful-kubernetes-commands/" title="Useful Kubernetes Commands"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-07</div><div class="info-item-2">Useful Kubernetes Commands</div></div><div class="info-2"><div class="info-item-1">There are some useful Kubernetes commands (updated from time to time)</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/en-us/images/avatar.png" onerror='this.onerror=null,this.src="/en-us/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">komorebi</div><div class="author-info-description"></div><div class="site-data"><a href="/en-us/archives/"><div class="headline">Articles</div><div class="length-num">30</div></a><a href="/en-us/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/en-us/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/2nfree"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/2nfree" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:komorebi2333@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#ffa07a"></i></a><a class="social-icon" href="https://twitter.com/2Nfree" target="_blank" title="Twitter"><i class="fa-brands fa-x-twitter" style="color:#4a7dbe"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Foreword"><span class="toc-number">1.</span> <span class="toc-text">Foreword</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.1.</span> <span class="toc-text">Introduction</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Preparation"><span class="toc-number">2.</span> <span class="toc-text">Preparation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Servers"><span class="toc-number">2.1.</span> <span class="toc-text">Servers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Server-Port"><span class="toc-number">2.2.</span> <span class="toc-text">Server Port</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Tools"><span class="toc-number">2.3.</span> <span class="toc-text">Basic Tools</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Install-Container-Runtime"><span class="toc-number">3.</span> <span class="toc-text">Install Container Runtime</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Server-System-Config"><span class="toc-number">4.</span> <span class="toc-text">Server System Config</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Disable-Selinux"><span class="toc-number">4.1.</span> <span class="toc-text">Disable Selinux</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Disable-SWAP"><span class="toc-number">4.2.</span> <span class="toc-text">Disable SWAP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pass-bridged-IPV4-traffic-to-iptables"><span class="toc-number">4.3.</span> <span class="toc-text">Pass bridged IPV4 traffic to iptables</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPVS-Config"><span class="toc-number">4.4.</span> <span class="toc-text">IPVS Config</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Set-up-time-synchronization-generally-cloud-service-vendors-have-already-set-it-up-local-servers-need-to-be-configured"><span class="toc-number">4.5.</span> <span class="toc-text">Set up time synchronization (generally cloud service vendors have already set it up, local servers need to be configured)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Install-Kubernetes"><span class="toc-number">5.</span> <span class="toc-text">Install Kubernetes</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Yum-Repo"><span class="toc-number">5.1.</span> <span class="toc-text">Yum Repo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Start-Kubelet"><span class="toc-number">5.2.</span> <span class="toc-text">Start Kubelet</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Images"><span class="toc-number">6.</span> <span class="toc-text">Images</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Get-Image-List"><span class="toc-number">6.1.</span> <span class="toc-text">Get Image List</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Download"><span class="toc-number">6.2.</span> <span class="toc-text">Download</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Control-Plane"><span class="toc-number">7.</span> <span class="toc-text">Control Plane</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Init"><span class="toc-number">7.1.</span> <span class="toc-text">Init</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Execute-Join-Control-Plane-in-master2"><span class="toc-number">7.2.</span> <span class="toc-text">Execute Join Control Plane in master2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Perform-configuration-on-all-masters"><span class="toc-number">7.3.</span> <span class="toc-text">Perform configuration on all masters</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Add-the-node-to-the-cluster"><span class="toc-number">8.</span> <span class="toc-text">Add the node to the cluster</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Install-the-CNI-network-plugin-do-it-on-master"><span class="toc-number">9.</span> <span class="toc-text">Install the CNI network plugin (do it on master)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Use-IPVS"><span class="toc-number">10.</span> <span class="toc-text">Use IPVS</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/kubernetes-logging-collection-5/" title="Kubernetes 日志收集（五）- 使用 Kafka 做中间层">Kubernetes 日志收集（五）- 使用 Kafka 做中间层</a><time datetime="2024-09-23T07:33:32.000Z" title="Created 2024-09-23 15:33:32">2024-09-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/some-ways-enhance-wsl-experience/" title="Some Ways to Enhance Your WSL Experience">Some Ways to Enhance Your WSL Experience</a><time datetime="2024-08-15T07:25:56.000Z" title="Created 2024-08-15 15:25:56">2024-08-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/cicd-in-kubernetes-based-jenkins-2/" title="从零实现CI/CD（二）- Jenkins 配置流水线">从零实现CI/CD（二）- Jenkins 配置流水线</a><time datetime="2024-07-04T07:41:11.000Z" title="Created 2024-07-04 15:41:11">2024-07-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/kubernetes-logging-collection-4/" title="Kubernetes 日志收集（四）- 基于 Fluent-bit Daemonset 的日志收集">Kubernetes 日志收集（四）- 基于 Fluent-bit Daemonset 的日志收集</a><time datetime="2024-05-22T10:26:58.000Z" title="Created 2024-05-22 18:26:58">2024-05-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/en-us/kubernetes-logging-collection-3/" title="Kubernetes 日志收集（三）- Logging operator 中使用 concat 多行合并相关问题">Kubernetes 日志收集（三）- Logging operator 中使用 concat 多行合并相关问题</a><time datetime="2024-05-13T04:26:58.000Z" title="Created 2024-05-13 12:26:58">2024-05-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By komorebi</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en-us/js/utils.js?v=5.3.2"></script><script src="/en-us/js/main.js?v=5.3.2"></script><div class="js-pjax"><script>(()=>{const e="shuoshuo"===GLOBAL_CONFIG_SITE.pageType,t=e=>"dark"===e?"dark":"light",s=(s=document,a)=>{const n=e?{"data-mapping":"specific","data-term":a}:{"data-mapping":"pathname"},o=(e=>{const t=document.createElement("script");return Object.entries(e).forEach(([e,s])=>{t.setAttribute(e,s)}),t})({src:"https://giscus.app/client.js","data-repo":"2nfree/2nfree.github.io","data-repo-id":"R_kgDOJEANRA","data-category-id":"DIC_kwDOJEANRM4CcNhM","data-theme":t(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0,...n});s.querySelector("#giscus-wrap").appendChild(o),e&&(window.shuoshuoComment.destroyGiscus=()=>{s.children.length&&(s.innerHTML="",s.classList.add("no-comment"))})};btf.addGlobalFn("themeChange",e=>{const s=document.querySelector("#giscus-wrap iframe");if(s){const a={giscus:{setConfig:{theme:t(e)}}};s.contentWindow.postMessage(a,"https://giscus.app")}},"giscus"),e?window.shuoshuoComment={loadComment:s}:btf.loadComment(document.getElementById("giscus-wrap"),s)})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/en-us/js/search/local-search.js?v=5.3.2"></script></div></div></body></html>